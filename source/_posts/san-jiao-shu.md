---
title: "三角数因子"
date: 2013-07-28 14:41
tags: Problems
---
原题是这样的：
> The sequence of triangle numbers is generated by adding the natural numbers. So the 7th triangle number would be 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28. The first ten terms would be:<!--more-->

> > 1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...

> Let us list the factors of the first seven triangle numbers:

> > 1: 1
> > 3: 1,3
> > 6: 1,2,3,6
> > 10: 1,2,5,10
> > 15: 1,3,5,15
> > 21: 1,3,7,21
> > 28: 1,2,4,7,14,28

> We can see that 28 is the first triangle number to have over five divisors.

> What is the value of the first triangle number to have over five hundred divisors?

为了解决这道题，首先想到的当然是穷举法，但在写完程序之后才发现穷举法是行不通的：穷举所花费的时间让人无法忍受，从1穷举到5000时已经要等上一阵子了。遂放弃，尝试其它方法。

从特殊出发，然后从特殊归纳，找出一般方法。为找出因子个数，可以对数进行质因数分解：
> 120 = 2 * 2 * 2 * 3 * 5
> 48 = 2 * 2 * 2 * 2 * 3

由于所有合数均可以分解成质因数的乘积，所以，一个数的因子可以由它的各个质因数组合而产生，如：120 所有因数为 
> 1，2，3，4，5，6，8，10，12，15，20，24，30，40，60，120

是由其所有质因数组合而成 120 = 2 ^ 3 * 3 ^ 1 * 5 ^ 1

由此，我们可以从其中选出 [0123]个2，[01]个3，[01]个5进行组合，总共有：

> 4 * 2 * 2 = 16

个因数，符合上面所罗列的各个因数。

由此，如果

``` python
number = 2 ^ a1 * 3 ^ a2 * …… * XX ^ an
```
则因数个数为：(a1+1) *(a2+1)...*(an+1)

``` python
import sys
sys.path.append("./")
import prime

def gen_table(lrange,rrange):
    tabs = []
    for i in xrange(lrange,rrange):
        if prime.is_prime(i):
            tabs.append(i) 
    return tabs

def get_number(num):
    global tab
    tab_local = [0 for i in xrange(len(tab))]
    for i in xrange(len(tab)):
        while(num % tab[i] == 0):
            num /= tab[i]
            tab_local[i] += 1
            if num < 2:
                break
    mul = 1
    border = i + 1
    for i in xrange(border):
        if tab_local[i] != 0:
            mul *= (tab_local[i] + 1)
    return mul

def calculate():
    num = 0
    for i in xrange(1,100000):
        num += i
        if get_number(num) > 500:
            return num

if __name__ == "__main__":
    tab = gen_table(2,10000)
    print calculate()

```
结果为 76576500
